{% extends 'base.html' %}

{% load static %}

{% block title %}地図+旅行プラン作成システム{% endblock %}

{% block contents %}
<link rel="stylesheet" type="text/css" href="{% static 'css/regulation.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/dragging.css' %}"/>

<div class="side side-space">
    <div>
        <span class="result">検索結果</span>
        <div class="scroll box1" id="tour_list" ondragover="f_dragover(event)">
            <ul class="ul_tags">
                {% for tour in tourism_list %}
                <li class="li_tags"><div class="item" draggable="true" id="tourism_list_name" ondragstart="f_dragstart(event)">{{ tour.tourism_name }}</div></li>
                {% empty %}
                <li class="li_tags"><div class="item" draggable="true" id="NOT_FOUND">検索結果がありませんでした。</div></li>
                <li class="li_tags"><div class="item" draggable="true" id="NOT_FOUND">もう一度検索してください</div></li>
                {% endfor %}
            </ul>
        </div>
        <p class="result drop_box box2" id="target" ondragover="dragover_handler(event)" ondrop="drop_handler(event)">
            <ul class="ul_tags">
                <li class="li_tags">
                </li>
            </ul>
    </div>
<script>
  function dragstart_handler(ev) {
    // Add the target element's id to the data transfer object
    ev.dataTransfer.setData("text/plain", ev.target.id);
  }

  window.addEventListener("DOMContentLoaded", () => {
    // Get the element by id
    const element = document.getElementById("tourism_list_name");
    // Add the ondragstart event listener
    element.addEventListener("dragstart", dragstart_handler);
  });
</script>

<script>
  function dragover_handler(ev) {
    ev.preventDefault();
    ev.dataTransfer.dropEffect = "move";
  }
  function drop_handler(ev) {
    ev.preventDefault();
    // 移動された要素のidを取得して、その要素をtargetのDOMに追加する
    const data = ev.dataTransfer.getData("text/plain");
    ev.target.appendChild(document.getElementById(data));
  }
</script>

    <div class="balance">
        <label for="site-search"></label>
        <form>
            <input type="search" id="site-search" name="q">
            <button>Search</button>
            <select name="prefecture" required>
                <option>---</option>
                {% for jp in prefecture_list %}
                <option>{{ jp.prefecture_name }}</option>
                {% empty %}
                <option>Not Found</option>
                {% endfor %}
            </select>
            <table class="result">
                <td>
                    <div>
                        <span class="result">ジャンル</span>
                        <br>
                        {% for spot in category_list %}
                        {% if spot.category_code == -1 or spot.category_code >= 25 %}
                        {% else %}
                        <input type="checkbox"/>{{ spot.category_name }}
                        {% endif %}
                        {% empty %}
                        <input type="checkbox"/>ERROR
                        {% endfor %}
                    </div>
                    </td>
                <td>
            </table>
        </form>
        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d12655606.084254637!2d140.4790958863645!3d37.14594589120638!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sja!2sjp!4v1674458027975!5m2!1sja!2sjp" width="500" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        <div class="btn_margin create_btn">
            <a class="btn btn-primary" href="{% url 'maplan:created_two' %}">次へ</a>
        </div>
    </div>
</div>
{% endblock %}